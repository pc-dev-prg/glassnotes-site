---
import Layout from "../layouts/Layout.astro";
import Navigation from "../components/Navigation.astro";
import Footer from "../components/Footer.astro";
import versionData from "../../version.json";
---

<Layout title="Product Ecosystem | GlassNotes - Desktop, Web & Mobile">
  <Navigation transition:persist />

  <main transition:animate="slide">
    <!-- Hero Section -->
    <section class="product-hero">
      <div class="container">
        <span class="badge reveal"
          ><span class="badge-dot"></span> The Ecosystem</span
        >
        <h1 class="reveal delay-1">One App.<br />Every Device.</h1>
        <p class="reveal delay-2">
          GlassNotes is evolving into a synchronized environment where your
          thoughts flow seamlessly between your Mac, the web, and your pocket.
        </p>
      </div>
    </section>
  </main>

  <!-- Platform Toggle / Quick Links -->
  <section class="platform-nav" transition:persist>
    <div class="platform-container">
      <a href="#desktop" class="platform-link active" data-section="desktop">
        <span class="icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            ><rect width="16" height="10" x="4" y="5" rx="2"></rect><line
              x1="12"
              y1="15"
              x2="12"
              y2="19"></line><line x1="8" y1="19" x2="16" y2="19"></line></svg
          >
        </span>
        <span>Desktop</span>
      </a>
      <a href="#web" class="platform-link" data-section="web">
        <span class="icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            ><circle cx="12" cy="12" r="10"></circle><line
              x1="2"
              y1="12"
              x2="22"
              y2="12"></line><path
              d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
            ></path></svg
          >
        </span>
        <span>Web</span>
      </a>
      <a href="#mobile" class="platform-link" data-section="mobile">
        <span class="icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            ><rect width="14" height="20" x="5" y="2" rx="2" ry="2"></rect><path
              d="M12 18h.01"></path></svg
          >
        </span>
        <span>Mobile</span>
      </a>
    </div>
  </section>

  <main transition:animate="slide">
    <!-- Desktop Section -->
    <section id="desktop" class="product-section scroll-offset">
      <div class="container">
        <div class="section-header reveal">
          <h2 class="section-title">The Desktop Powerhouse</h2>
          <p class="section-subtitle">
            Deep dive into the ultimate environment for work and creativity.
          </p>
        </div>

        <div class="bento-grid">
          <!-- Native Section -->
          <div class="bento-item glass large reveal">
            <span class="feature-badge">Native Performance</span>
            <h3>Built for macOS.</h3>
            <p>
              Not just another Electron app. GlassNotes is written to leverage
              the full power of Apple Silicon, ensuring instant startup, smooth
              scrolling, and zero lag even with thousands of notes.
            </p>
            <div class="features-mini-grid">
              <div class="mini-item"><span>ðŸš€</span> Instant Open</div>
              <div class="mini-item"><span>ðŸ’¾</span> Minimal RAM</div>
              <div class="mini-item"><span>ðŸ”‹</span> Energy Efficient</div>
            </div>
          </div>

          <!-- Customization Section -->
          <div class="bento-item glass medium reveal delay-1">
            <span class="feature-badge">Atmosphere</span>
            <h3>Premium Themes.</h3>
            <p>
              Your workspace should inspire you. Switch between curated themes
              like <strong>Midnight</strong>, <strong>Solarized</strong>, or <strong
                >Frosted Glass</strong
              > with a single click.
            </p>
            <div class="theme-dots">
              <span style="background: #1a1b26"></span>
              <span style="background: #fdf6e3"></span>
              <span style="background: #5c7cff"></span>
            </div>
          </div>

          <!-- Organization Section -->
          <div class="bento-item glass medium reveal delay-2">
            <span class="feature-badge">Organization</span>
            <h3>Smart Folders.</h3>
            <p>
              Stop searching, start finding. Dynamic folders automatically group
              your notes based on tags, dates, or complex search queries.
            </p>
          </div>

          <!-- Wiki-links Section -->
          <div class="bento-item glass large reveal delay-3">
            <span class="feature-badge">Knowledge Web</span>
            <h3>The Power of Wiki-links.</h3>
            <p>
              Build a non-linear knowledge base. Connect concepts using [[double
              brackets]] and visualize how your ideas intersect. It's your
              second brain, structured by you.
            </p>
            <div
              class="placeholder-img"
              style="height: 120px; margin-top: 20px;"
            >
              [Visual: Connection Graph Placeholder]
            </div>
          </div>

          <!-- Versioning Section -->
          <div class="bento-item glass small reveal">
            <span class="feature-badge">Safety</span>
            <h3>Snapshot History.</h3>
            <p>
              Never lose a thought. Every edit is tracked, allowing you to
              travel back in time and restore previous versions of any note.
            </p>
          </div>

          <!-- Offline Section -->
          <div class="bento-item glass small reveal delay-1">
            <span class="feature-badge">Reliability</span>
            <h3>Fully Offline.</h3>
            <p>
              Work in the middle of the desert or on a plane. GlassNotes is
              designed to be fully functional without an internet connection.
            </p>
          </div>
        </div>

        <!-- Modern Showcase Sections -->
        <div class="feature-showcase-container">
          <!-- Showcase 1: The Editor -->
          <div class="showcase-item reveal">
            <div class="showcase-content">
              <span class="showcase-number">01</span>
              <h2>A Canvas for Your Thoughts.</h2>
              <p>
                Writing should feel like thinking. Our minimalist editor removes
                every distraction, leaving only you and your ideas. With
                real-time markdown rendering and beautiful typography, your
                notes become a work of art.
              </p>
              <ul class="showcase-bullets">
                <li>Focus Mode for zero-distraction</li>
                <li>Customizable typography & spacing</li>
                <li>Seamless Markdown integration</li>
              </ul>
            </div>
            <div class="showcase-visual">
              <div class="glass floating-screen">
                <div class="screen-header">
                  <span class="dot red"></span>
                  <span class="dot yellow"></span>
                  <span class="dot green"></span>
                </div>
                <div class="screen-content">
                  [Screenshot: Immersive Editor Experience]
                </div>
              </div>
            </div>
          </div>

          <!-- Showcase 2: Unified Search -->
          <div class="showcase-item alternate reveal">
            <div class="showcase-visual">
              <div class="glass floating-screen">
                <div class="screen-header">
                  <span class="dot red"></span>
                  <span class="dot yellow"></span>
                  <span class="dot green"></span>
                </div>
                <div class="screen-content">
                  [Screenshot: Lightning Fast Search]
                </div>
              </div>
            </div>
            <div class="showcase-content">
              <span class="showcase-number">02</span>
              <h2>Find it in a heartbeat.</h2>
              <p>
                Your knowledge base is only as good as your ability to retrieve
                information. Our unified search searches through titles,
                content, and tags instantly. No matter how large your library
                grows, the answer is always a few keystrokes away.
              </p>
              <div class="stats-box">
                <div class="stat">
                  <span class="val">&lt; 10ms</span>
                  <span class="lab">Search latency</span>
                </div>
                <div class="stat">
                  <span class="val">10k+</span>
                  <span class="lab">Notes optimized</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Web Section -->
    <section id="web" class="product-section alternate scroll-offset">
      <div class="container">
        <div class="split-section">
          <div class="content reveal">
            <span class="badge"
              ><span
                class="badge-dot"
                style="background: var(--accent); box-shadow: 0 0 10px var(--accent);"
              ></span> Web Companion</span
            >
            <h2>Work from anywhere.</h2>
            <p>
              Need to check a note on a borrowed laptop? Our web version
              provides a lightweight, secure environment to access your entire
              library from any modern browser.
            </p>
            <ul class="feature-list">
              <li>Real-time Cloud Sync</li>
              <li>Secure Browser Access</li>
              <li>Zero-installation Setup</li>
            </ul>
            <a href="/pricing" class="cta-button secondary">Explore Web App</a>
          </div>
          <div class="visual reveal delay-1">
            <div class="glass browser-mockup">
              <div class="browser-header">
                <div class="dots"><span></span><span></span><span></span></div>
                <div class="url-bar">glassnotes.app/vault</div>
              </div>
              <div class="browser-content">
                <div class="placeholder-img">[Web Interface Preview]</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Mobile Section -->
    <section id="mobile" class="product-section scroll-offset">
      <div class="container">
        <div class="glass mobile-vision reveal">
          <div class="content">
            <span class="feature-badge">Coming 2026</span>
            <h2>Mobile Vision.</h2>
            <p>
              Capture ideas on the go. The future GlassNotes mobile app will
              bring the same minimalist glass aesthetics to iOS and Android,
              focusing on quick-capture and lightning-fast search.
            </p>
            <div class="waitlist-ui">
              <p>Want to be among the first testers?</p>
              <a href="/#footer" class="cta-button primary">Join the Waitlist</a
              >
            </div>
          </div>
          <div class="mobile-visuals">
            <div class="phone-frame">[Mobile UI Sneak Peek]</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Technical Specs -->
    <section class="tech-specs product-section reveal">
      <div class="container">
        <h2 class="section-title">Technical DNA</h2>
        <div class="specs-grid">
          <div class="spec-item">
            <h4>Engine</h4>
            <p>Swift / Svelte Hybrid</p>
          </div>
          <div class="spec-item">
            <h4>Storage</h4>
            <p>SQLite / Markdown Files</p>
          </div>
          <div class="spec-item">
            <h4>Security</h4>
            <p>End-to-End Encryption</p>
          </div>
          <div class="spec-item">
            <h4>Sync</h4>
            <p>Private Cloud Relay</p>
          </div>
        </div>
      </div>
    </section>

    <section class="final-cta">
      <div class="container">
        <div class="glass reveal" style="padding: 60px; text-align: center;">
          <h2>Ready to clear your mind?</h2>
          <p style="margin-bottom: 30px;">
            Start your journey with the desktop app today.
          </p>
          <div class="hero-actions" style="justify-content: center;">
            <a href={versionData.downloadUrl} class="cta-button primary"
              >Download for macOS</a
            >
            <a href="/" class="cta-button secondary">Back to Home</a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer transition:persist />

  <style>
    .product-hero {
      padding: 180px 20px 80px;
      text-align: center;
    }
    .product-hero h1 {
      font-size: 5rem;
      line-height: 1;
      margin-bottom: 24px;
      letter-spacing: -3px;
      font-weight: 800;
    }
    .product-hero p {
      font-size: 1.4rem;
      color: var(--text-muted);
      max-width: 700px;
      margin: 0 auto;
      line-height: 1.6;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .platform-nav {
      display: flex;
      justify-content: center;
      margin-bottom: 80px;
      position: sticky;
      top: 110px;
      z-index: 900;
      pointer-events: none;
      /* Prevent view-transition context from breaking sticky/blur */
      view-transition-name: none !important;
    }
    .platform-container {
      display: flex;
      padding: 8px;
      border-radius: 100px;
      gap: 8px;
      background: rgba(255, 255, 255, 0.03) !important;
      backdrop-filter: blur(20px) saturate(180%) !important;
      -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
      border: 1px solid var(--glass-border);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      pointer-events: auto;
    }
    .platform-link {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 24px;
      border-radius: 100px;
      text-decoration: none;
      color: var(--text-muted);
      font-weight: 600;
      border: 1px solid transparent;
      transition: all 0.3s ease;
    }
    .platform-link .icon {
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.7;
      transition: all 0.3s ease;
    }
    .platform-link:hover .icon,
    .platform-link.active .icon {
      opacity: 1;
      color: #fff;
    }
    .platform-link.active,
    .platform-link:hover {
      background: rgba(92, 124, 255, 0.3) !important;
      color: #fff;
      border: 1px solid rgba(92, 124, 255, 0.4);
      box-shadow: 0 4px 20px rgba(92, 124, 255, 0.3);
    }

    .product-section {
      padding: 100px 0;
    }
    .scroll-offset {
      scroll-margin-top: 180px;
    }
    .product-section.alternate {
      background: rgba(255, 255, 255, 0.02);
    }
    .section-header {
      text-align: center;
      margin-bottom: 60px;
    }
    .section-subtitle {
      font-size: 1.2rem;
      color: var(--text-muted);
    }

    .placeholder-img {
      background: rgba(255, 255, 255, 0.03);
      border: 1px dashed rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      font-size: 0.9rem;
      width: 100%;
    }

    .browser-mockup {
      border-radius: 12px 12px 0 0;
      overflow: hidden;
      box-shadow: 0 30px 60px rgba(0, 0, 0, 0.5);
    }
    .browser-header {
      background: rgba(255, 255, 255, 0.05);
      padding: 12px;
      display: flex;
      align-items: center;
      gap: 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    .dots {
      display: flex;
      gap: 6px;
    }
    .dots span {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
    }
    .url-bar {
      background: rgba(0, 0, 0, 0.2);
      padding: 4px 12px;
      border-radius: 6px;
      font-size: 0.7rem;
      flex-grow: 1;
      color: var(--text-muted);
    }
    .browser-content {
      height: 300px;
      padding: 20px;
    }

    .mobile-vision {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      padding: 60px;
      align-items: center;
    }
    .phone-frame {
      height: 400px;
      width: 200px;
      background: rgba(15, 17, 26, 0.8);
      border: 8px solid #222;
      border-radius: 36px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #444;
    }

    .specs-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 40px;
      margin-top: 60px;
    }
    .spec-item h4 {
      color: var(--primary);
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    .spec-item p {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .features-mini-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 15px;
      margin-top: 25px;
    }
    .mini-item {
      background: rgba(255, 255, 255, 0.05);
      padding: 12px;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .theme-dots {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    .theme-dots span {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    /* Feature Showcase */
    .feature-showcase-container {
      margin-top: 120px;
      display: flex;
      flex-direction: column;
      gap: 160px;
    }
    .showcase-item {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 80px;
      align-items: center;
    }
    .showcase-item.alternate {
      grid-template-columns: 1fr 1fr;
    }
    .showcase-number {
      font-size: 5rem;
      font-weight: 900;
      line-height: 1;
      color: rgba(92, 124, 255, 0.1);
      display: block;
      margin-bottom: -20px;
      letter-spacing: -5px;
    }
    .showcase-content h2 {
      font-size: 3.5rem;
      letter-spacing: -2px;
      line-height: 1.1;
      margin-bottom: 24px;
    }
    .showcase-content p {
      font-size: 1.15rem;
      color: var(--text-muted);
      line-height: 1.6;
      margin-bottom: 30px;
    }
    .showcase-bullets {
      list-style: none;
      padding: 0;
    }
    .showcase-bullets li {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
      font-weight: 600;
      color: var(--text-main);
    }
    .showcase-bullets li::before {
      content: "â†’";
      color: var(--primary);
    }

    .floating-screen {
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 50px 100px rgba(0, 0, 0, 0.6);
      transform: perspective(1000px) rotateY(-10deg) rotateX(5deg);
      transition: transform 0.5s ease;
    }
    .showcase-item.alternate .floating-screen {
      transform: perspective(1000px) rotateY(10deg) rotateX(5deg);
    }
    .floating-screen:hover {
      transform: perspective(1000px) rotateY(0deg) rotateX(0deg)
        translateY(-10px);
    }
    .screen-header {
      background: rgba(255, 255, 255, 0.05);
      padding: 10px 15px;
      display: flex;
      gap: 6px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      opacity: 0.5;
    }
    .dot.red {
      background: #ff5f56;
    }
    .dot.yellow {
      background: #ffbd2e;
    }
    .dot.green {
      background: #27c93f;
    }
    .screen-content {
      height: 350px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(15, 17, 26, 0.4);
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .stats-box {
      display: flex;
      gap: 40px;
      margin-top: 40px;
    }
    .stat {
      display: flex;
      flex-direction: column;
    }
    .stat .val {
      font-size: 2rem;
      font-weight: 800;
      color: var(--primary);
    }
    .stat .lab {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-muted);
    }

    @media (max-width: 1024px) {
      .showcase-item,
      .showcase-item.alternate {
        grid-template-columns: 1fr;
        gap: 40px;
        text-align: center;
      }
      .showcase-bullets li {
        justify-content: center;
      }
      .showcase-visual {
        order: -1;
      }
      .floating-screen {
        transform: none !important;
        max-width: 500px;
        margin: 0 auto;
      }
      .stats-box {
        justify-content: center;
      }
    }

    @media (max-width: 768px) {
      .product-hero h1 {
        font-size: 3rem;
      }
      .mobile-vision {
        grid-template-columns: 1fr;
        text-align: center;
      }
      .split-section {
        grid-template-columns: 1fr;
      }
      .platform-nav {
        top: 90px;
      }
      .platform-link span:not(.icon) {
        display: none;
      }
    }
  </style>

  <script>
    function setupScrollSpy() {
      const sections = document.querySelectorAll(".scroll-offset");
      const navLinks = document.querySelectorAll(".platform-link");

      const observerOptions = {
        root: null,
        rootMargin: "-48% 0px -48% 0px", // Tightened zone to 4% of viewport center to avoid flickering
        threshold: 0,
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const id = entry.target.getAttribute("id");
            navLinks.forEach((link) => {
              link.classList.toggle(
                "active",
                link.getAttribute("data-section") === id,
              );
            });
          }
        });
      }, observerOptions);

      sections.forEach((section) => observer.observe(section));
    }

    // Run on initial load and after transitions
    setupScrollSpy();
    document.addEventListener("astro:after-swap", setupScrollSpy);
  </script>
</Layout>
